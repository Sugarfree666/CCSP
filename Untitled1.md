# 复杂约束性问题

> 1. 我想购买一台苹果品牌的笔记本电脑，要求内存至少为 16GB，且重量低于1.5公斤，价格不高于8000元。
> 2. 我想找一种高血压药物，要求：1. 不含‘磺胺’成分（因为我过敏）；2. 不会与我正在服用的‘阿司匹林’产生拮抗作用；3. 属于医保乙类。
> 3. 汤姆·汉克斯演过哪些战争题材且上映时间在1995年之后的高评分电影？

## 思路

根据 GoT 框架解决复杂约束问题（G,T,E,R）。

T：思维变换：聚合思维，精炼思维，生成思维。

将这个问题的推理结构建模为一个有向图。节点代表thought，边代表thought之间的依赖关系。

具体问题：

输入问题 $Q$：我想购买一台苹果品牌笔记本电脑，内存至少为 16GB，必须搭载M2芯片，价格不高于8000元。

1. 初始化阶段：将查询 $Q$ 初始化为根节点 $V_{root}$ 。

2. 通过prompt将根节点分解为4个子约束任务，使用**生成思维**生成四个思考结点

   1. $V_1$ 查找苹果品牌笔记本电脑（Anchor）
   2. $V_2$ 查找内存至少为16GB的笔记本电脑（Filter）
   3. $V_3$ 查找搭载M2芯片的笔记本电脑（Anchor）
   4. $V_4$ 查找价格不高于8000元的笔记本电脑（Filter）

   > - 为了提高子思维的精确度，在生成思维之前，要告诉LLM中KG有哪些属性，避免它生成一些无关的思维。
   > - 在生成思维前，参考KG返回的约束实体的度的信息：
   >   - 如果Degree特别大，作为Filter节点。其他的可以直接Anchor思维节点
   >   - Filter节点在查询时不做查询操作，Anchor节点作查询操作。

   将每个子查询使用KG查询（KG查询方法），得到查询集合 $A_i$；

   > 

   对查询集合评分&排名：如果Score太低，进行重新思考或修正思考，也就是**精炼思维**。

3. 使用**聚合思维**将思考$V_{1},V_{3}$和$V_{2},V_{4}$分别聚合。得到的聚合结果利用**生成思维** 得到$V_{12}$和 $V_{34}$ 作为下一思考结点。

   1. $V_{13}$：查找既是苹果品牌，又是M2芯片的笔记本电脑。
   2. $V_{24}$：查找内存至少为16GB，但价格不高于8000元的电脑。

   > 对于思考节点中的实体，根据社区检测算法找到在KG中联系紧密的实体进行聚合，不再盲目的聚合。
   >
   > 在这个例子中，使 $V_1$和 $V_3$ 聚合，$V_2$ 和 $V_4$ 聚合；如果是两个Anchor节点进行聚合，则要把思维聚合后在两个查询的结果集合中，找到满足思维的答案 $A$。如果是两个Filter思考节点聚合，则进行多规则思考节点的生成。

   - 如果查询集合 $A$ 为空，回溯思考，使用**精炼思维**基于原思考节点生成一个新的思考节点。
     - 比如说 $A$ 为空，$V_{13}$ 节点进行回溯，对 $V_3$ 点进行适当的放宽条件。
     - 然后用这个节点与 $V_1$ 节点重新聚合。

4. 使用**聚合思维**对$V_{13}$和 $V_{24}$ 进行聚合，利用**生成思维**得到 $V_{final}$思考结点，包含着满足各个约束的笔记本电脑信息。前面 $A$ 集合也就是 $A_{final}$，$V_{final}$根据这个 $A_{final}$ 得到最后的**答案集合**。

   将得到的答案集合和问题 $Q$ 输入给LLM生成答案。

   

   



# 数据集构造

















