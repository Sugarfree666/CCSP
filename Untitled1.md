复杂约束性问题

> 1. 推荐几家在北京国贸附近、人均300元以下、有独立包间、适合10人商务宴请且招牌菜不是海鲜的餐厅。
> 2. 我想购买一台苹果品牌的笔记本电脑，要求内存至少为 16GB，且重量低于1.5公斤，价格不高于8000元。
> 3. 我想找一种高血压药物，要求：1. 不含‘磺胺’成分（因为我过敏）；2. 不会与我正在服用的‘阿司匹林’产生拮抗作用；3. 属于医保乙类。

思路：

根据 GoT 框架解决复杂约束问题（G,T,E,R）。

T：思维变换：聚合思维，精炼思维，生成思维。

将这个问题的推理结构建模为一个有向图。节点代表thought，边代表thought之间的依赖关系。

具体问题：

输入问题 $Q$：我想购买一台苹果品牌的笔记本电脑，要求内存至少为 16GB，且重量低于1.5公斤，价格不高于8000元。

1. 初始化阶段：将查询 $Q$ 初始化为根节点 $V_{root}$ 。

2. 通过prompt将根节点分解为4个子约束任务，使用**生成思维**生成四个思考结点

   1. $V_1$ 查找苹果品牌笔记本电脑
   2. $V_2$ 查找内存至少为16GB的笔记本电脑
   3. $V_3$ 查找重量低于1.5kg的笔记本电脑
   4. $V_4$ 查找价格不高于8000元的笔记本电脑

   将每个子查询使用KG查询（KG查询方法），得到查询集合 $A_i$；

   对查询集合评分&排名：如果Score太低，进行重新思考或修正思考，也就是**精炼思维**。

3. 使用**聚合思维**将思考$V_{1},V_{2}$和$V_{3},V_{4}$分别两两聚合。得到的聚合结果利用**生成思维** 得到$V_{12}$和 $V_{34}$ 作为下一思考结点。

   1. $V_{12}$：查找既是苹果品牌，内存至少16GB的电脑。
   2. $V_{34}$：查找重量低于1.5KG，价格不高于8000元的电脑。

   - 将之前的查询集合进行对应的两两聚合得到 $A_m$与 $A_n$。LLM会根据这个聚合后的集合进行查找。

   - 如果查询集合 $A_m$ 或 $A_n$ 为空，回溯思考，使用**精炼思维**基于原思考节点生成一个新的思考节点。
     - 比如说 $A_n$ 为空，基于 $V_3$ 节点生成 $V^1_{3}$ :查找重量低于1.8kg的笔记本电脑。
     - 然后用这个节点与 $V_4$ 节点重新聚合。

   - 对查询集合评分&排名：如果Score太低，进行重新思考或修正思考，也就是**精炼思维**。

4. 使用**聚合思维**对$V_{12}$和 $V_{34}$ 进行聚合，利用**生成思维**得到 $V_{final}$思考结点，包含着满足各个约束的笔记本电脑信息。将$A_m$与 $A_n$进行合并得到 $A_{final}$，$V_{final}$根据这个 $A_{final}$ 得到最后的**答案集合**。

   对答案集合评分&排名：如果Score太低，进行重新思考或修正思考，也就是**精炼思维**。

   将得到的答案集合和问题 $Q$ 输入给LLM生成答案。

   

   

**引入KG结构感知**

- 聚合路径规划，对于思考节点中的实体，根据社区检测找到在KG中联系紧密的实体进行聚合，不再盲目的聚合。
- 基于节点度的思维生成，在生成思维前，先获取约束中对应的KG实体的度。
  - 如果度很大，可以将这个大思维生成很多子思维。
  - 如果度很小：不需要分解思维。

- $V_{A}$ (轻薄) 和 $V_{B}$ (高性能) 聚合后结果为空，不仅仅让 LLM 瞎猜“放宽条件”，而是去 KG 中寻找连接 $V_{A}$ 和 $V_{B}$ 的 **最短路径** 或 **桥接节点**。
  - 发现 $V_{A}$ 和 $V_{B}$ 虽然没有直接交集，但它们都连接到一个中间节点 $V_{bridge}$: "全能本 " 。
  - GoT 自动插入一个新的思维节点 $V_{new}$ ("查找全能本")。修改图结构：$V_{A} \rightarrow V_{new} \leftarrow V_{B}$。


